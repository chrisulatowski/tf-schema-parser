# Terraform Schema Parser

[![Python Version](https://img.shields.io/badge/python-3.8%2B-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

A command-line tool to interactively explore Terraform provider schemas (starting with AzureRM) and generate copy-pasteable HCL templates for resources. It parses schema JSON files generated by `terraform providers schema -json` and offers resource searching, filtering, and template exporting with placeholders and interpolations.

## Features
- Interactive search for resources and data sources with partial name matching.
- Generate HCL templates: full (all attributes) or required-only versions.
- Smart placeholders with interpolations for common references (e.g., referencing `azurerm_storage_account.example.name`).
- Export options: print, save to file, or copy to clipboard (via `pyperclip`).
- Support for nested blocks, comments with descriptions, and deprecation warnings.
- Non-interactive mode for scripting and automation.

## Installation
1. Clone the repository:

git clone https://github.com/chrisulatowski/tf-schema-parser.git
cd tf-schema-parser

2. (Optional) Create and activate a virtual environment:

python -m venv .venv
source .venv/bin/activate  # Linux/Mac
.venv\Scripts\activate  # Windows

3. Install dependencies (clipboard feature requires `pyperclip`):

pip install pyperclip

4. Download the AzureRM schema:

./download_azurerm_schema.sh

This script will:
- Run `terraform init` to download the provider based on the configuration in `main.tf`.
- Generate the schema JSON using `terraform providers schema -json`.
- Remove the large provider binaries to free up space.

If you need a different provider version, edit `main.tf` (e.g., update `version = "~> 4.38.1"` to your desired version) and re-run the script.

## Usage
Run interactively:

python tf-schema-parser.py

- Search for resource or data source names (e.g., `storage_blob`).
- Select a match to generate the HCL template.
- Options include: print again (`p`), save (`f`), copy required-only (`c`), copy full (`o`), back (`b`).

Non-interactive example:

python tf-schema-parser.py --resource azurerm_storage_blob --output blob.tf


Toggle between resource and data source modes in interactive mode by typing `data`.

## Schema Management
- Schemas are stored at `azurerm_schema.json` by default.
- Use `--schema-path` to specify an alternate schema file.
- Update schemas using the provided bash script `download_azurerm_schema.sh`, which handles initialization and cleanup.

## Contributing
1. Fork the repository.
2. Create a feature branch (`git checkout -b feature/new-thing`).
3. Commit your changes (`git commit -m 'Add new feature'`).
4. Push the branch (`git push origin feature/new-thing`).
5. Create a pull request.

Issues and pull requests are welcome!

## License
This project is licensed under the MIT License. See [LICENSE](LICENSE) for details.
